<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>STAN Bot Demo</title>
    <style>
      body {
        font-family: system-ui, sans-serif;
        max-width: 680px;
        margin: 20px auto;
        padding: 12px;
      }
      .bubble {
        padding: 10px 12px;
        border-radius: 12px;
        margin: 8px 0;
      }
      .me {
        background: #eef;
        align-self: flex-end;
      }
      .bot {
        background: #efe;
      }
      #chat {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      #row {
        display: flex;
        gap: 8px;
        margin-top: 12px;
      }
      input,
      button {
        padding: 10px;
        font-size: 16px;
      }
      #user {
        width: 40%;
      }
      #msg {
        flex: 1;
      }
    </style>
  </head>
  <body>
    <h1>STAN Bot Demo</h1>
    <div id="chat"></div>

    <div id="row">
      <input id="user" placeholder="user_id (e.g., alice)" />
      <input id="msg" placeholder="Type a message..." />
      <button id="send">Send</button>
    </div>

    <script>
      const chat = document.getElementById("chat");
      const user = document.getElementById("user");
      const msg = document.getElementById("msg");
      document.getElementById("send").onclick = async () => {
        if (!user.value || !msg.value) return;
        add("me", msg.value);
        const r = await fetch("/chat", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ user_id: user.value, message: msg.value }),
        }).then((r) => r.json());
        add("bot", r.reply);
        msg.value = "";
      };
      function add(who, text) {
        const b = document.createElement("div");
        b.className = `bubble ${who}`;
        b.textContent = text;
        chat.appendChild(b);
        window.scrollTo(0, document.body.scrollHeight);
      }
    </script>
  </body>
</html>
